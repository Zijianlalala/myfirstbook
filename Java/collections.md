# 集合相关
> 与`Collection`有关的知识点

## 介绍一下集合
Java的集合类定义主要在`java.util`包中，支持泛型，主要提供了3种集合类
1. `Set`——一种保证没有重复元素的集合。
2. `List`——一种有序列表的集合。
3. `Map`——一种通过键值查找的映射表集合。

## List
### ArrayList
内部是由数组实现的。通过`Iterator`遍历`List`永远是最高效的方式。
### LinkedList
内部是由双向 链表实现的。

## Map

### HashMap
根据键的`hashCode`值存储数据。非线程安全的。最多允许一个键是`null`。允许多条记录的值是`null`。

#### 存储结构
数组+链表+红黑树

`Node`类(哈希桶节点)

通过好的哈希算法和扩容机制来减少哈希冲突和哈希数组的占用空间。

#### 功能实现
##### 确定哈希桶数组索引的位置
```
hash()
1. h = key.hashCode()
2. h ^ (h >>> 16)// 降低hash冲突的几率
indexFor()
1. h & (length-1)
```

##### resize()
JDK1.8中的优化是把容量定位2的幂，所以在避免了再次哈希计算，直接通过与运算(e.hash & oldCap)就可以得到旧元素在新数组中的索引
JDK1.8中对链表实行尾插法重排列，故不会改变原来链表顺序。

在多线程情况下，两个线程同时进入resize()方法会导致出现循环链表。触发条件
1. 多线程
2. 头插法（导致前后续关系倒置）


## Set
